% 最终答案，备付金
clear
load XY
C_L = [];
c0 = [];
for n = 1:30
    c0 = [c0;[1,-100,100]];
end
c0(1,:) = [1,-400,700];    
c0(2,:) = [1,-400,700];    
c0(3,:) = [1,-400,700];    
c0(5,:) = [1,-200,700];
c0(30,:) = [1,-30,0.1]

g = [];
for n = 1:30
    fun = @(c,x)c(1)*normcdf(x,c(2),c(3));
    [c, d] = lsqcurvefit(fun,c0(n,:),X(n,:),Y(n,:));
    C_L = [C_L;[c,d,-norminv(0.01/c(1),c(2),c(3))]];  
    if d > 0.001
        g = [g,n];
    end
end